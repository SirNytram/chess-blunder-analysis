<html>
 
    
  <head>
    <title>Chess Blunder Analysis</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="//code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
    <script src="https://code.jquery.com/jquery-1.12.4.js"></script>
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>

    <script>
   

    $(document).ready(function() {
      $("#content1").html('<a id="board1" href="#" title="" >Board 1</a>');
      $("#content1 #board1").tooltip({ content: '<img src="static/board-3.5.svg" width=300/>' }); 

      $("#content2").html('<a id="board2" href="#" title="" >Board 2</a>');
      $("#content2 #board2").tooltip({ content: '<img src="static/board-6.5.svg" width=300/>' }); 
  
     
      });
      </script>
    </head>
  <body>
    
    <!-- <div class="tooltip"><img class="size_of_img" src="https://babeltechreviews.com/wp-content/uploads/2018/07/rendition1.img_.jpg" alt="Image 1" /><span class="tooltiptext">grewon.pdf</span></div>  -->
    <div>
      <h1>Chess Blunder Analysis</h1>
      <form method="POST">
        <textarea name="pgn" rows="6" cols="60">{{pgn}}</textarea><br>
        <input type="checkbox" name="detailed">Detailed<br>
        <input type="text" name="think_time" value="{{think_time}}"><br>
        <input type="submit">
      </form>
    </div>  
    <div>
      Render Time: {{time}} ms
    </div>

    <div>
      <canvas id="myChart"></canvas>
    </div>

    <script>
      const labels = [
      {% for move in moves %}
        '{{move['move_no_graph']}}',
        {% endfor %}
      ];
    
      const data = {
        labels: labels,
        datasets: [
        {
          label: 'Score',
          backgroundColor: 'rgb(255, 99, 132)',
          borderColor: 'rgb(255, 99, 132)',
          data: [ {% for move in moves %}{{move['score_graph']}},{% endfor %} ],
        },
        {
          label: 'Mid Line',
          borderColor: "#3e95cd",
          data: [ {% for move in moves %}0,{% endfor %} ],
        }
      ]
      };
    
      const config = {
        type: 'line',
        data: data,
        options: {}
      };
    </script>

    <script>
      const myChart = new Chart(
        document.getElementById('myChart'),
        config
      );
    </script> 




   
    <div>
      <table border=1 style="border-collapse:collapse">
        <thead>
          <th>move no</th>
          <th>score</th>
          <th>move</th>
          <th>score diff</th>
          <th>comment</th>
          <th></th>
          <th>top moves</th>
        </thead>
        
        {% for move in moves %}
        <tr>
          <td>{{move['move_no']}}</td>
          <td>{{move['score']}}</td>
          <td>{{move['move']|safe}}</td>
          <td>{{move['score_diff']}}</td>
          <td><a id="board-{{move['move_no_full']}}" href="static/board-{{move['move_no_full']}}.svg" title=" ">{{move['comment']|safe}}</a></td>
          <td></td>
          {% for top_move in move['top_moves'] %}
          <td>{{top_move['move']|safe}} {{top_move['score']|safe}}</td>
          {% endfor %}
        </tr>
        
        {% endfor %}

      </table><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br>

  



    </div>

    <script>
      {% for move in moves %}
        $("#board-{{move['move_no_full']}}").tooltip({ content: '<img src="static/board-{{move['move_no_full']}}.svg" width=300/>' });
      {% endfor %}
    </script>
    

  </body>
</html>
